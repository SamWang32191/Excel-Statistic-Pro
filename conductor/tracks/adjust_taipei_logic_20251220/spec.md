# Specification: Case and Service List Adjustment (Multi-Sheet & Taipei Logic)

## 1. Overview
本計畫旨在優化「個案清單」與「服務統計」的邏輯。主要調整包含：
- 「個案清單」支援讀取多個工作表（台北、新北），並實作差異化的欄位映射與過濾邏輯。
- 「個案清單」UI 調整，包含欄位設定、預設值，以及預覽結果的分組顯示。
- 「服務清單」在選擇台北時，新增子類別（身障/老福）選擇功能。
- 統一輸出至 GAS 的工作表命名規範。

## 2. Functional Requirements

### 2.1 個案清單模式 (Case List Mode)
- **多工作表讀取邏輯**：
    - 搜尋名稱包含「台北」的工作表 -> 套用台北邏輯。
    - 搜尋名稱包含「新北」的工作表 -> 套用新北邏輯。
- **UI 與預設值調整 (Column Configuration)**：
    - **新增欄位**：介面需新增「類別列」輸入框（針對台北）。
    - **預設值與驗證**：系統需確保介面預設顯示以下欄位代號，並以此進行讀取：
        - **新北設定**：
            - 性別: G, 年齡: F, 居住狀況: O, CMS等級: J
        - **台北設定**：
            - 類別: B (新增), 性別: H, 年齡: G, 居住狀況: P, CMS等級: K
- **台北資料過濾邏輯**：
    - 僅統計「類別(B列)」為「老福」或「身障」的資料（精確比對）。
    - 忽略類別為空值或其它文字的資料。
- **預覽呈現 (Preview UI)**：
    - 台北的統計結果在畫面上必須**明確分為兩個區塊**顯示：「台北身障」與「台北老福」。
    - 區塊標題應包含對應的月份（例如：台北身障01）。
- **數據匯總與命名**：
    - 統計結果需依類別拆分為：`台北身障{MM}`、`台北老福{MM}`、`新北{MM}`（MM 為介面輸入的月份）。

### 2.2 服務清單模式 (Service List Mode)
- **UI 調整**：
    - 當「縣市」選擇為「台北」時，顯示 **Radio Buttons** 供使用者選擇「身障」或「老福」。
- **命名邏輯**：
    - 送至 GAS 的工作表名稱需根據選擇的類別與月份，命名為：`台北身障{MM}` 或 `台北老福{MM}`。

## 3. Non-Functional Requirements
- **效能**：多工作表讀取應保持流暢，避免阻塞瀏覽器 UI。
- **容錯性**：若 Excel 檔案中缺少預期名稱的工作表，應記錄錯誤但不應導致整個程式崩潰（可跳過該縣市）。

## 4. Acceptance Criteria
- [ ] **個案清單 UI**：正確顯示台北與新北的獨立欄位設定，且預設值符合規格（新北 G/F/O/J；台北 B/H/G/P/K）。
- [ ] **個案清單預覽**：上傳後，預覽畫面能將台北資料拆分為「身障」與「老福」兩個獨立區塊顯示。
- [ ] **個案清單邏輯**：能正確過濾台北的「老福/身障」資料。
- [ ] **服務清單 UI**：選擇台北時能透過 Radio Button 切換子類別。
- [ ] **輸出驗證**：GAS 接收到的資料表名稱正確包含月份與類別（如 `台北身障01`, `新北01`）。

## 5. Out of Scope
- 修改現有的統計計算演算法（僅調整讀取範圍、欄位映射與過濾規則）。
