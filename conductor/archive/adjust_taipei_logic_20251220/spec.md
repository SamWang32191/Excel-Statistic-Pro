# Specification: Case and Service List Adjustment (Multi-Sheet & Taipei Logic)

## 1. Overview
本計畫旨在優化「個案清單」與「服務統計」的邏輯。主要調整包含：
- 「個案清單」支援讀取多個工作表（台北、新北），並實作差異化的欄位映射與過濾邏輯。
- **UI 佈局重構**：將功能切換按鈕（個案名單/服務清冊）移至最上方。
- **個案清單模式**：隱藏縣市下拉選單，並同時顯示「台北」與「新北」的欄位設定區塊。
- **服務清單模式**：選擇台北時，新增子類別（身障/老福）選擇功能。
- **邏輯增強**：處理工作表缺失狀況，僅將有資料的縣市傳送至 GAS。

## 2. Functional Requirements

### 2.1 全域 UI 調整 (Global UI)
- **功能切換**：「個案名單」與「服務清冊」的切換按鈕需移至畫面**最上方**，作為第一層級的導航。

### 2.2 個案清單模式 (Case List Mode)
- **UI 呈現與互動**：
    - **縣市選擇**：在此模式下，**不顯示**縣市下拉選單。
    - **欄位設定區塊**：畫面需同時呈現兩個獨立的設定區塊：
        1.  **台北設定區**：包含 類別(B), 性別(H), 年齡(G), 居住狀況(P), CMS等級(K) 等輸入框。
        2.  **新北設定區**：包含 性別(G), 年齡(F), 居住狀況(O), CMS等級(J) 等輸入框。
- **多工作表讀取與過濾邏輯**：
    - 搜尋名稱包含「台北」的工作表 -> 套用台北邏輯（包含類別 B 欄位過濾：僅保留「老福」或「身障」）。
    - 搜尋名稱包含「新北」的工作表 -> 套用新北邏輯。
- **資料缺失處理 (Missing Data Handling)**：
    - 若未找到對應縣市的工作表（例如：Excel 中只有台北，無新北）：
        - 預覽區該縣市區塊應顯示 **「無資料 (No Data)」** 提示。
        - **不執行**該縣市的統計計算。
        - **不傳送**該縣市的資料至 GAS。
- **預覽呈現 (Preview UI)**：
    - 台北的統計結果需拆分為：「台北身障」與「台北老福」。
    - 新北的統計結果顯示為：「新北」。
    - 若某縣市無資料，則明確標示無資料。
- **數據匯總與命名 (GAS Output)**：
    - 僅傳送有資料的項目。命名規則：`台北身障{MM}`、`台北老福{MM}`、`新北{MM}`。

### 2.3 服務清單模式 (Service List Mode)
- **UI 呈現與互動**：
    - **縣市選擇**：在此模式下，**必須顯示**縣市下拉選單供使用者選擇。
    - **子類別選擇**：當「縣市」選擇為「台北」時，顯示 **Radio Buttons** 供使用者選擇「身障」或「老福」。
- **命名邏輯**：
    - 送至 GAS 的工作表名稱需根據選擇的類別與月份，命名為：`台北身障{MM}` 或 `台北老福{MM}`。

## 3. Non-Functional Requirements
- **效能**：多工作表讀取應保持流暢，避免阻塞瀏覽器 UI。
- **容錯性**：若 Excel 檔案中缺少預期名稱的工作表，應記錄錯誤但不應導致整個程式崩潰。

## 4. Acceptance Criteria
- [ ] **全域 UI**：功能切換按鈕位於頁面最上方。
- [ ] **個案清單 UI**：選擇「個案名單」時，隱藏縣市選單，並同時顯示台北與新北的設定區塊。
- [ ] **服務清單 UI**：選擇「服務清冊」時，顯示縣市選單；選擇台北時顯示子類別 Radio Button。
- [ ] **缺失處理**：上傳僅含台北的 Excel，預覽區新北顯示「無資料」，且傳送至 GAS 時僅包含台北的資料。
- [ ] **資料過濾**：台北資料正確依據「類別」欄位拆分或過濾。
- [ ] **GAS 輸出**：GAS 接收到的資料表名稱與內容正確且不包含空資料的縣市。

## 5. Out of Scope
- 修改現有的統計計算演算法（僅調整讀取範圍、欄位映射與過濾規則）。